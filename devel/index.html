<!-- $Id$ -->
<!-- $Source$ -->

<html>
<head>
<title>ProFTPD Developer's Guide: Module Development</title>
</head>

<body bgcolor=white>

<hr><br>
<center>
<img src="../images/proftpd.png" border=0>
<br><br>
<h3><b>ProFTPD Developer's Guide: Module Development</b></h3>
<i><b>ProFTPD Version 1.2</b></i><br>
</center>
<hr><br>

<p>
<center><a href="../toc.html">Table of Contents</a></center><br>

<p>
<b>Module Development</b><br>
As with any software development, there are certain things to watch out for
when building a module.  There are also other things to consider as part of
the development process, such as <code>configure</code> scripts and
documentation.

<p>
If you are developing a module for wider distribution with <code>proftpd</code>,
please keep in mind the overall design philosophy: no use of
<code>system(2)</code> or the <code>exec</code> family of system calls.  Helper
applications to accompany the module are acceptable; the server (and modules)
should simply not invoke any code outside of its control.

<p>
Also, respect the normal filesystem permissions.  <code>proftpd</code> has
always honored the normal Unix permissions, and may provide access controls
<i>in addition to</i> those of the filesystem, but <b>do not</b> override
them.  This only leads to trouble.

<p>
<b>Documentation</b><br>
<i><b>No</b> modules or patches will be accepted into the ProFTPD source
<b>without documentation.</b></i>  Modules submitted without documents on what
they do, on how to properly use any configuration directives the module
might define, or on how to install and use the module, are next to useless by
the ProFTPD community.

<p>
Patches without descriptions of what they are fixing, <i>and why</i>, force developers to read the code of the patch in order to decipher the purpose; the
author of the patch has the best insight into the patch's purpose.

<p>
<b>Common tasks</b><br>
As you develop your module, you will find that there are some routines and
operations needed that will have inevitably been done before, either in
other modules, or in the core code itself.  These pages describe some of the
common tasks you can expect to encounter, and how they can be done:
<ul>
  <li>using <a href="third-party-libraries.html">third-party libraries</a>
      in your module
  <li>detecting <a href="session-credentials.html">session credentials</a>
      (<i>i.e.</i> user, groups, class)
  <li>adding module-specific <a href="site-commands.html">SITE</a> commands
  <li>module <a href="module-logging.html">logging</a>
  <li><a href="chroot-workarounds.html">working</a> around the
      <code>chroot()</code> function
</ul>
Here are some other <a href="tips.html">tips</a> to keep in mind as you work
on your module.

<p>
<b>Licensing</b><br>
For the most part, this is easy -- GPL.  However, when working with
third-party libraries or code, be sure to include the necessary copyrights
and licensing information as required by the use of those files.  Some
licensing issues to keep in mind are mentioned here:
<pre>
  <a href="http://www.gnu.org/licenses/gpl-faq.html#GPLModuleLicense">http://www.gnu.org/licenses/gpl-faq.html#GPLModuleLicense</a>
  <a href="http://www.gnu.org/licenses/gpl-faq.html#GPLAndPlugins">http://www.gnu.org/licenses/gpl-faq.html#GPLAndPlugins</a>
</pre>
Due to the nature of <code>proftpd</code>'s module interface, third-party
modules are considered part of the main binary, and thus by definition fall
under the GPL (or <a href="http://www.gnu.org/licenses/license-list.html#GPLCompatibleLicenses">GPL-compatible licenses</a>), unless explicitly excluded
(the OpenSSL code is excluded this way).
<p>
If developing modules that rely on cryptographic code, please be cognizant of
any governmental laws or restrictions on the cryptographic code in use,
in its licensing and distribution.

<p>
<b>Security</b><br>
Always, <b><i>always</i></b>, <b>ALWAYS</b> check, verify, and sanitize user
input, be it from configuration files such as <code>.ftpaccess</code>, from
the configuration directive arguments for your modules, from any FTP commands
you've created, etc etc.  If you're going to open and write a file with
root privileges, check to see if the file exists first.  If it does, check
whether it is a symlink, has data, whatever.  <b>Do not</b> blindly write to a
file name, unless you are absolutely certain of the conditions of the directory
and file to which you are writing.

<p>
<b>Secure Practices</b><br>
Here are some recommended <a href="secure-programming.html">sources</a> for
further reading on secure programming and practices to keep in mind.

<p>
<center><a href="../toc.html">Table of Contents</a></center><br>

<hr><br>

Author: <i>$Author$</i><br>
Last Updated: <i>$Date$</i><br>

<br><hr>

<font size=2><b><i>
&copy; Copyright 2000-2003 TJ Saunders<br>
 All Rights Reserved<br>
</i></b></font>

<hr><br>

</body>
</html>
