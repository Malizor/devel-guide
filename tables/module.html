<!-- $Id$ -->
<!-- $Source$ -->

<html>
<head>
<title>ProFTPD Developer's Guide: &quot;Module&quot; Tables</title>
</head>

<body bgcolor=white>

<hr><br>
<center>
<img src="../images/proftpd.png" border=0>
<br><br>
<h3><b>ProFTPD Developer's Guide: &quot;Module&quot; Tables</b></h3>
<i><b>ProFTPD Version 1.2</b></i><br>
</center>
<hr><br>

<p>
<center><a href="../toc.html">Table of Contents</a></center><br>

<p>
<b>&quot;Module&quot; Tables</b><br>
The <a href="../src/include/modules.h.html#module_struc">module</a> table
defines the main interface between the module and the core ProFTPD engine,
providing pointers to the other handler tables, giving a name to the module,
<i>etc etc</i>.  The API version used by the module is denoted as well, so that
ProFTPD can recognize whether it is capable of using this module, or whether
the given API version is too old or too new.  As ProFTPD maintains an internal
list of modules in a doubly-linked list arrangment, the table defines two
pointers to the others which are set when ProFTPD starts; <b>do not</b> define
these fields yourself.

<p>
Each module can supply up to two initialization routines via
this module table.  The first initialization function is called immediately
after the module is loaded, while the second is called after ProFTPD is
connected to a client, and the main ProFTPD server (if not in <code>inetd</code>
mode) has forked off.  The purpose of this second initialization function,
called the session initialization function, is to let
the module perform any necessary preparatory work once a client is connected
and ProFTPD is ready to provide service to the new client.  In
<code>inetd</code> mode, the session initialization function will be called
immediately after ProFTPD is loaded, because ProFTPD is <i>always</i> in
&quot;child mode&quot; when run from <code>inetd</code>.  Note that both of
these initialization routines are optional.  If you do not need them, simply
set the function pointer to <code>NULL</code> in the module table.

<p>
<b>Example</b><br>
<pre>
module sample_module = {
  <font color=green>/* Always NULL */</font>
  NULL, NULL,

  <font color=green>/* Module API version (current version: 2.0) */</font>
  0x20,

  <font color=green>/* Module name */</font>
  "sample",

  <font color=green>/* Module configuration handler table */</font>
  sample_conftab,

  <font color=green>/* Module command handler table */</font>
  sample_cmdtab,

  <font color=green>/* Module authentication handler table */</font>
  NULL,

  <font color=green>/* Module initialization function */</font>
  sample_init,

  <font color=green>/* Session initialization function */</font>
  sample_sess_init
};
</pre>

<p>
<center><a href="../toc.html">Table of Contents</a></center><br>

<hr><br>

Author: <i>$Author$</i><br>
Last Updated: <i>$Date$</i><br>

<br><hr>

<font size=2><b><i>
&copy; Copyright 2000-2003 TJ Saunders<br>
 All Rights Reserved<br>
</i></b></font>

<hr><br>

</body>
</html>
